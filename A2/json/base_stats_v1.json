{
  "$schema": "https://vega.github.io/schema/vega-lite/v5.json",
  "width": 715,
  "height": 430,
  "background": "#f4f8ff",
  "title": {
    "text": "Distribution of All Pokémon Base Stats by Type",
    "fontSize": 20,
    "fontWeight": "bold",
    "anchor": "start",
    "offset": 20
  },
  "config": {
    "view": {"stroke": "transparent"},
    "axis": {
      "gridColor": "#dee2e6",
      "gridWidth": 1,
      "labelFontSize": 12,
      "titleFontSize": 14,
      "titleFontWeight": "normal"
    },
    "legend": {
      "labelFontWeight": "normal",
      "titleFontWeight": "normal"
    }
  },

  "data": {"url": "csv/base_stats.csv"},

  "params": [
    {
      "name": "StatSelect",
      "value": "base_attack",
      "bind": {
        "input": "select",
        "options": ["base_attack", "base_defense", "base_stamina"],
        "labels": ["Base Attack", "Base Defense", "Base Stamina"],
        "name": "Select Stat: "
      }
    },
    {
      "name": "TypeHighlight",
      "select": {"type": "point", "fields": ["type"]},
      "bind": "legend"
    }
  ],

  "transform": [{"calculate": "datum[StatSelect]", "as": "Value"}],

  "layer": [
    {
      "mark": {"type": "tick", "size": 12},
      "encoding": {
        "x": {
          "field": "type",
          "type": "nominal",
          "axis": {"title": null, "labelAngle": -45},
          "scale": {"paddingInner": 0.3, "paddingOuter": 0.2}
        },
        "y": {
          "field": "Value",
          "type": "quantitative",
          "axis": {"title": "Stat Value"},
          "scale": {"zero": false}
        },
        "color": {
          "field": "type",
          "type": "nominal",
          "legend": {
            "title": ["Pokémon Type", "↓ Click to Filter"],
            "symbolStrokeColor": "#472fce",
            "symbolStrokeWidth": 1.5,
            "symbolSize": 100,
            "offset": 24
          },
          "scale": {"range": ["#b7abfd"]},
          "condition": {"param": "TypeHighlight", "value": "#8671fc"}
        },
        "opacity": {
          "condition": {"param": "TypeHighlight", "value": 0.8},
          "value": 0.15
        },
        "tooltip": [
          {"field": "pokemon_name", "title": "Pokémon"},
          {"field": "Value", "title": "Stat Value"},
          {"field": "type", "title": "Type"}
        ]
      }
    },

    {
      "data": {
        "values": [
          {"pokemon_name": "Deoxys", "type": "Psychic", "Value": 345, "stat": "base_attack"}
        ]
      },
      "transform": [
        {"calculate": "StatSelect == datum.stat ? 1 : 0", "as": "show"},
        {"filter": "datum.show == 1"}
      ],
      "mark": {
        "type": "text",
        "align": "left",
        "baseline": "middle",
        "dx": 8,
        "dy": -5,
        "fontSize": 12,
        "color": "#333"
      },
      "encoding": {
        "x": {"field": "type"},
        "y": {"field": "Value"},
        "text": {"value": "Deoxys — Highest Base Attack"}
      }
    }
  ]
}
