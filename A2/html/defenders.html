<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Best Defender by Tier</title>
  <script src="https://cdn.jsdelivr.net/npm/vega@5"></script>
  <script src="https://cdn.jsdelivr.net/npm/vega-lite@5"></script>
  <script src="https://cdn.jsdelivr.net/npm/vega-embed@6"></script>
  <script src="https://ajax.googleapis.com/ajax/libs/webfont/1.6.26/webfont.js"></script>

  <link href="https://fonts.googleapis.com/css2?family=PT+Sans&display=swap" rel="stylesheet">
  <style>
    body { font-family: 'PT Sans', sans-serif; }
    select, label { font-family: 'PT Sans', sans-serif; font-size: 14px; }
  </style>
</head>
<body>
  <div id="vis"></div>

  <script type="text/javascript">
    const spec = {
      "$schema": "https://vega.github.io/schema/vega-lite/v5.json",
      "description": "Pokémon defender lollipop chart by score",
      "title": { "text": "Best Defender by Tier", "font": "PT Sans", "fontSize": 20, "fontWeight": "bold", "anchor": "middle" },
      "width": 1000,   // wider width
      "height": 400,
      "autosize": { "type": "fit-x", "contains": "padding" },
      "data": { "url": "defenders.csv" },

      "params": [
        {
          "name": "tierSelect",
          "value": "S",
          "bind": {
            "input": "select",
            "options": ["S", "A+", "A", "B", "C", "D"],
            "labels": ["S", "A+", "A", "B", "C", "D"],
            "name": "Filter Tier: "
          }
        }
      ],

      "transform": [ { "filter": "datum.Tier == tierSelect" } ],

      "layer": [
        {
          "mark": { "type": "bar", "size": 2, "color": "#b6ccfe" },
          "encoding": {
      "x": {
          "field": "Score",
          "type": "quantitative",
          "title": "Defender Score",
          "axis": {
            "titlePadding": 20,
            "grid": true,
            "domain": false,
            "ticks": false,
            "values": [10000, 20000, 30000, 40000, 50000, 60000, 70000, 80000],
            "gridColor": "#ededed",
            "gridWidth": 1,
            "format": "~s"
          }
      },
            "y": { 
              "field": "Name", 
              "type": "ordinal", 
              "sort": "-x",
              "axis": { "title": null }  // keeps names, removes axis title
            }
          }
        },
        {
          "mark": { "type": "point", "filled": true, "opacity": 1, "size": 100, "color": "#abc4ff" },
          "encoding": {
            "x": { "field": "Score", "type": "quantitative" },
            "y": { "field": "Name", "type": "ordinal", "sort": "-x" },
            "tooltip": [
              {"field": "Name", "title": "Pokémon: "},
              {"field": "Tier", "title": "Tier: "},
              {"field": "Defense", "title": "Defense: "},
              {"field": "Stamina", "title": "Stamina: "},
              {"field": "Score", "title": "Score: "}
            ]
          }
        },
        {
          "mark": { "type": "text", "align": "left", "dx": 5, "font": "PT Sans" },
          "encoding": {
            "x": { "field": "Score", "type": "quantitative" },
            "y": { "field": "Name", "type": "ordinal", "sort": "-x" },
            "text": { "field": "Score" },
            "color": { "value": "black" }
          }
        }
      ],

      "config": {
        "axis": { "labelFont": "PT Sans", "titleFont": "PT Sans", "labelFontSize": 12, "titleFontSize": 14 },
        "legend": null,
        "view": { "stroke": "transparent" },
        "padding": { "left": 250, "right": 100 } // more space for long names & scores
      }
    };

    WebFont.load({
      google: { families: ['PT Sans:400,700'] },
      active: function() { vegaEmbed('#vis', spec); }
    });
  </script>
</body>
</html>
